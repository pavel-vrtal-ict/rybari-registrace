<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ryb√°≈ôsk√© z√°vody</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>üêü Ryb√°≈ôsk√© z√°vody</h1>
            <p class="subtitle">Registrace ¬∑ Check-in ¬∑ √ölovky</p>
        </div>
        <button class="header-settings-btn" id="btn-open-settings" title="Nastaven√≠ URL pro QR k√≥dy">‚öôÔ∏è</button>
    </header>

    <nav id="main-nav">
        <button class="nav-btn active" data-view="competitions">
            <span class="nav-icon">üèÜ</span>
            <span class="nav-label">Z√°vody</span>
        </button>
        <button class="nav-btn" data-view="registration">
            <span class="nav-icon">üìù</span>
            <span class="nav-label">Registrace</span>
        </button>
        <button class="nav-btn" data-view="checkin">
            <span class="nav-icon">üìç</span>
            <span class="nav-label">Check-in</span>
        </button>
        <button class="nav-btn" data-view="catches">
            <span class="nav-icon">üêü</span>
            <span class="nav-label">√ölovky</span>
        </button>
        <button class="nav-btn" data-view="results">
            <span class="nav-icon">üìä</span>
            <span class="nav-label">P≈ôehled</span>
        </button>
    </nav>

    <main id="app">
        <!-- Z√ÅVODY -->
        <section id="view-competitions" class="view active">
            <div class="section-header">
                <h2>Z√°vody</h2>
                <button class="btn btn-primary" id="btn-new-competition">+ Nov√Ω z√°vod</button>
            </div>
            <div id="competitions-list" class="card-list"></div>
            <div id="no-competitions" class="empty-state">
                <span class="empty-icon">üé£</span>
                <p>Zat√≠m nem√°te ≈æ√°dn√© z√°vody.</p>
                <p class="hint">Kliknƒõte na ‚Äû+ Nov√Ω z√°vod" pro vytvo≈ôen√≠.</p>
            </div>
        </section>

        <!-- REGISTRACE -->
        <section id="view-registration" class="view">
            <div class="section-header">
                <h2>Registrace z√°vodn√≠ka</h2>
            </div>
            <div id="no-competition-for-reg" class="empty-state">
                <span class="empty-icon">üìã</span>
                <p>Nejd≈ô√≠ve vytvo≈ôte z√°vod.</p>
            </div>
            <form id="registration-form" class="form-card" style="display:none;">
                <div class="form-group">
                    <label for="reg-competition">Z√°vod</label>
                    <select id="reg-competition" required></select>
                </div>
                <div class="form-group">
                    <label for="reg-name">Jm√©no a p≈ô√≠jmen√≠</label>
                    <input type="text" id="reg-name" placeholder="Jan Nov√°k" required>
                </div>
                <div class="form-group">
                    <label for="reg-club">Ryb√°≈ôsk√Ω spolek / odd√≠l</label>
                    <input type="text" id="reg-club" placeholder="MO ƒåRS T≈ôeb√≠ƒç">
                </div>
                <div class="form-group">
                    <label for="reg-phone">Telefon</label>
                    <input type="tel" id="reg-phone" placeholder="+420 123 456 789">
                </div>
                <div class="form-group">
                    <label for="reg-email">E-mail</label>
                    <input type="email" id="reg-email" placeholder="jan@email.cz">
                </div>
                <div class="form-group">
                    <label for="reg-category">Kategorie</label>
                    <select id="reg-category">
                        <option value="dospeli">Dospƒõl√≠</option>
                        <option value="mladez">Ml√°de≈æ (do 18 let)</option>
                        <option value="deti">Dƒõti (do 12 let)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="reg-note">Pozn√°mka</label>
                    <textarea id="reg-note" rows="2" placeholder="Voliteln√° pozn√°mka..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-full">Zaregistrovat</button>
            </form>
        </section>

        <!-- CHECK-IN -->
        <section id="view-checkin" class="view">
            <div class="section-header">
                <h2>Check-in u rybn√≠ka</h2>
            </div>
            <div id="checkin-content"></div>
        </section>

        <!-- √öLOVKY -->
        <section id="view-catches" class="view">
            <div class="section-header">
                <h2>Nahl√°sit √∫lovek</h2>
            </div>
            <div id="catches-content"></div>
        </section>

        <!-- P≈òEHLED -->
        <section id="view-results" class="view">
            <div class="section-header">
                <h2>P≈ôehled z√°vodn√≠k≈Ø</h2>
            </div>
            <div id="results-controls" style="display:none;">
                <div class="form-group">
                    <label for="results-competition">Z√°vod</label>
                    <select id="results-competition"></select>
                </div>
                <div class="results-stats" id="results-stats"></div>
            </div>
            <div id="participants-list" class="participants-table-wrap"></div>
            <div id="no-participants" class="empty-state">
                <span class="empty-icon">üë•</span>
                <p>Zat√≠m ≈æ√°dn√≠ registrovan√≠ z√°vodn√≠ci.</p>
            </div>
            <div id="results-actions" style="display:none;">
                <button class="btn btn-secondary" id="btn-export-csv">üì• Export CSV</button>
                <button class="btn btn-secondary" id="btn-print">üñ®Ô∏è Tisk</button>
            </div>
        </section>
    </main>

    <!-- MODAL: Nov√Ω z√°vod -->
    <div id="modal-competition" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modal-competition-title">Nov√Ω z√°vod</h3>
                <button class="modal-close" id="modal-close-competition">&times;</button>
            </div>
            <form id="competition-form">
                <div class="form-group">
                    <label for="comp-name">N√°zev z√°vodu</label>
                    <input type="text" id="comp-name" placeholder="Poh√°r starosty 2026" required>
                </div>
                <div class="form-group">
                    <label for="comp-date">Datum</label>
                    <input type="date" id="comp-date" required>
                </div>
                <div class="form-group">
                    <label for="comp-time">ƒåas zah√°jen√≠</label>
                    <input type="time" id="comp-time" value="07:00">
                </div>
                <div class="form-group">
                    <label for="comp-location">M√≠sto kon√°n√≠</label>
                    <input type="text" id="comp-location" placeholder="Rybn√≠k Velk√Ω, T≈ôeb√≠ƒç" required>
                </div>
                <div class="form-group">
                    <label for="comp-max">Max. poƒçet z√°vodn√≠k≈Ø</label>
                    <input type="number" id="comp-max" min="1" value="50">
                </div>
                <div class="form-group">
                    <label for="comp-ponds">Rybn√≠ky (stanovi≈°tƒõ)</label>
                    <input type="text" id="comp-ponds" placeholder="Velk√Ω rybn√≠k, Mal√Ω rybn√≠k, Jezero">
                    <small class="form-hint">Oddƒõlte ƒç√°rkou. Ka≈æd√Ω rybn√≠k dostane vlastn√≠ QR k√≥d pro check-in.</small>
                </div>
                <div class="form-group">
                    <label for="comp-catch-limit">Poƒçet √∫lovk≈Ø v cenƒõ (pak p≈ô√≠platek)</label>
                    <input type="number" id="comp-catch-limit" min="1" value="2">
                    <small class="form-hint">Po p≈ôekroƒçen√≠ tohoto poƒçtu mus√≠ z√°vodn√≠k doplatit.</small>
                </div>
                <div class="form-group">
                    <label for="comp-desc">Popis / pravidla</label>
                    <textarea id="comp-desc" rows="3" placeholder="Pravidla z√°vodu, povolen√© n√°strahy..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-full" id="btn-save-competition">Ulo≈æit z√°vod</button>
            </form>
        </div>
    </div>

    <!-- MODAL: Detail z√°vodu -->
    <div id="modal-detail" class="modal-overlay">
        <div class="modal modal-wide">
            <div class="modal-header">
                <h3>Detail z√°vodu</h3>
                <button class="modal-close" id="modal-close-detail">&times;</button>
            </div>
            <div id="competition-detail-body"></div>
        </div>
    </div>

    <!-- MODAL: QR k√≥d -->
    <div id="modal-qr" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modal-qr-title">QR k√≥d</h3>
                <button class="modal-close" id="modal-close-qr">&times;</button>
            </div>
            <div id="qr-body" class="qr-body"></div>
        </div>
    </div>

    <!-- MODAL: Notifikace p≈ô√≠platek -->
    <div id="modal-payment" class="modal-overlay">
        <div class="modal modal-alert">
            <div class="payment-alert">
                <span class="payment-icon">üí∞</span>
                <h3>P≈ô√≠platek za √∫lovek!</h3>
                <p id="payment-message"></p>
                <button class="btn btn-primary btn-full" id="btn-payment-ok">Rozum√≠m</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Nastaven√≠ URL pro QR k√≥dy -->
    <div id="modal-settings" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3>‚öôÔ∏è Nastaven√≠ URL pro QR k√≥dy</h3>
                <button class="modal-close" id="modal-close-settings">&times;</button>
            </div>
            <div style="margin-bottom:1rem;padding:0.85rem;background:var(--warning-light);border-radius:var(--radius-sm);border:1px solid var(--warning);font-size:0.9rem;">
                <strong>Proƒç je to pot≈ôeba?</strong><br>
                QR k√≥d mus√≠ odkazovat na ve≈ôejnou webovou adresu, aby ho z√°vodn√≠k mohl naskenovat mobilem.
                Lok√°ln√≠ cesta <code>file://</code> na jin√©m za≈ô√≠zen√≠ nefunguje.
            </div>
            <div class="form-group">
                <label for="settings-base-url">Ve≈ôejn√° URL adresa aplikace</label>
                <input type="url" id="settings-base-url" placeholder="https://vas-github.github.io/rybari-registrace/">
                <small class="form-hint">
                    Zadejte adresu po nasazen√≠ na GitHub Pages nebo Netlify.<br>
                    Dokud nem√°te ve≈ôejnou URL, pou≈æijte manu√°ln√≠ check-in v z√°lo≈æce Check-in.
                </small>
            </div>
            <button class="btn btn-primary btn-full" id="btn-save-settings">Ulo≈æit</button>
        </div>
    </div>

    <!-- BANNER: lok√°ln√≠ provoz -->
    <div id="local-banner" class="local-banner" style="display:none;">
        ‚ö†Ô∏è Aplikace bƒõ≈æ√≠ lok√°lnƒõ ‚Äì QR k√≥dy nefunguj√≠.
        <button class="btn btn-sm" id="btn-banner-settings" style="margin-left:0.75rem;background:rgba(255,255,255,0.2);color:#fff;border:1px solid rgba(255,255,255,0.4);">Zadat URL</button>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast"></div>

    <script src="app.js"></script>
</body>
</html>
