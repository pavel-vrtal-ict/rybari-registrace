<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HlybuÄek â€“ Evidence rybolovu</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

    <header>
        <div class="header-content">
            <h1>ğŸ£ HlybuÄek</h1>
            <p class="subtitle">Evidence rybolovu Â· Kapr 45â€“60 cm</p>
        </div>
        <button class="header-settings-btn" id="btn-open-settings" title="NastavenÃ­">âš™ï¸</button>
    </header>

    <div id="sync-bar" class="sync-bar sync-local">
        <span id="sync-icon">ğŸ’¾</span>
        <span id="sync-text">LokÃ¡lnÃ­ reÅ¾im</span>
        <button class="sync-setup-btn" id="btn-sync-setup">Nastavit Firebase</button>
    </div>

    <nav id="main-nav">
        <button class="nav-btn active" data-view="rybari">
            <span class="nav-icon">ğŸ‘¤</span>
            <span class="nav-label">RybÃ¡Å™i</span>
        </button>
        <button class="nav-btn" data-view="dochazka">
            <span class="nav-icon">ğŸ“…</span>
            <span class="nav-label">DochÃ¡zka</span>
        </button>
        <button class="nav-btn" data-view="ulovky">
            <span class="nav-icon">ğŸŸ</span>
            <span class="nav-label">Ãšlovky</span>
        </button>
        <button class="nav-btn" data-view="navstevy">
            <span class="nav-icon">ğŸ‘¥</span>
            <span class="nav-label">NÃ¡vÅ¡tÄ›vy</span>
        </button>
        <button class="nav-btn" data-view="statistiky">
            <span class="nav-icon">ğŸ“Š</span>
            <span class="nav-label">Statistiky</span>
        </button>
    </nav>

    <main id="app">

        <!-- RYBÃÅ˜I -->
        <section id="view-rybari" class="view active">
            <div class="section-header">
                <h2>RybÃ¡Å™i</h2>
                <div style="display:flex;gap:.5rem;">
                    <button class="btn btn-secondary btn-sm" id="btn-reg-qr">ğŸ“± QR registrace</button>
                    <button class="btn btn-primary" id="btn-new-fisher">+ PÅ™idat</button>
                </div>
            </div>
            <div id="fishers-list" class="card-list"></div>
            <div id="no-fishers" class="empty-state">
                <span class="empty-icon">ğŸ‘¤</span>
                <p>ZatÃ­m nejsou pÅ™idÃ¡ni Å¾Ã¡dnÃ­ rybÃ¡Å™i.</p>
                <p class="hint">KliknÄ›te na â€+ PÅ™idat" nebo vyvÄ›ste QR kÃ³d pro registraci.</p>
            </div>
        </section>

        <!-- DOCHÃZKA -->
        <section id="view-dochazka" class="view">
            <div class="section-header">
                <h2>DochÃ¡zka</h2>
            </div>
            <div class="inline-form">
                <div class="form-row-2">
                    <div class="form-group">
                        <label for="ci-fisher">RybÃ¡Å™</label>
                        <select id="ci-fisher"></select>
                    </div>
                    <div class="form-group">
                        <label for="ci-date">Datum</label>
                        <input type="date" id="ci-date">
                    </div>
                </div>
                <button class="btn btn-primary btn-full" id="btn-ci-submit">âœ“ Zapsat pÅ™Ã­chod</button>
            </div>
            <div id="dochazka-content"></div>
        </section>

        <!-- ÃšLOVKY -->
        <section id="view-ulovky" class="view">
            <div class="section-header">
                <h2>Ãšlovky</h2>
            </div>
            <div class="inline-form">
                <div class="form-row-2">
                    <div class="form-group">
                        <label for="catch-fisher">RybÃ¡Å™</label>
                        <select id="catch-fisher"></select>
                    </div>
                    <div class="form-group">
                        <label for="catch-date">Datum</label>
                        <input type="date" id="catch-date">
                    </div>
                </div>
                <div class="form-row-2">
                    <div class="form-group">
                        <label for="catch-length">DÃ©lka kapra (cm)</label>
                        <input type="number" id="catch-length" min="10" max="120" placeholder="napÅ™. 52">
                        <span class="form-hint" id="catch-length-hint"></span>
                    </div>
                    <div class="form-group form-group-vcenter">
                        <label class="check-label">
                            <input type="checkbox" id="catch-kept">
                            <span>Vzal rybu domÅ¯</span>
                        </label>
                    </div>
                </div>
                <button class="btn btn-primary btn-full" id="btn-catch-submit">ğŸŸ Zapsat Ãºlovek</button>
            </div>
            <div id="ulovky-content"></div>
        </section>

        <!-- NÃVÅ TÄšVY -->
        <section id="view-navstevy" class="view">
            <div class="section-header">
                <h2>NÃ¡vÅ¡tÄ›vy</h2>
            </div>
            <div class="inline-form">
                <div class="form-row-2">
                    <div class="form-group">
                        <label for="visit-fisher">ÄŒlen (kdo pozval)</label>
                        <select id="visit-fisher"></select>
                    </div>
                    <div class="form-group">
                        <label for="visit-date">Datum</label>
                        <input type="date" id="visit-date">
                    </div>
                </div>
                <div class="form-group">
                    <label for="visit-name">JmÃ©no nÃ¡vÅ¡tÄ›vy</label>
                    <input type="text" id="visit-name" placeholder="JmÃ©no hosta">
                </div>
                <div class="visit-fee-row">
                    <label class="check-label">
                        <input type="checkbox" id="visit-carp">
                        <span>Vzal kapra (+400 KÄ)</span>
                    </label>
                    <div class="visit-fee-display" id="visit-fee-display">300 KÄ</div>
                </div>
                <button class="btn btn-primary btn-full" id="btn-visit-submit">ğŸ‘¥ Zapsat nÃ¡vÅ¡tÄ›vu</button>
            </div>
            <div id="navstevy-content"></div>
        </section>

        <!-- STATISTIKY -->
        <section id="view-statistiky" class="view">
            <div class="section-header">
                <h2>Statistiky</h2>
                <select id="stats-year" class="year-select"></select>
            </div>
            <div id="statistiky-content"></div>
        </section>

    </main>

    <!-- REGISTRACE â€“ fullscreen overlay po naskenovÃ¡nÃ­ QR -->
    <div id="reg-overlay" class="checkin-overlay" style="display:none;">
        <div class="checkin-card">
            <div class="checkin-fish-icon">ğŸ£</div>
            <h2>HlybuÄek</h2>
            <p class="checkin-location">ğŸ“ Registrace novÃ©ho Älena</p>
            <form id="reg-form" style="text-align:left;margin-top:1.1rem;">
                <div class="form-group">
                    <label for="reg-name">JmÃ©no a pÅ™Ã­jmenÃ­</label>
                    <input type="text" id="reg-name" placeholder="Jan NovÃ¡k" required>
                </div>
                <div class="form-group">
                    <label for="reg-number">ÄŒÃ­slo rybÃ¡Å™skÃ©ho lÃ­stku</label>
                    <input type="text" id="reg-number" placeholder="12345">
                </div>
                <div class="form-group">
                    <label for="reg-phone">Telefon</label>
                    <input type="tel" id="reg-phone" placeholder="+420 123 456 789">
                </div>
                <button type="submit" class="btn btn-primary btn-full" style="margin-top:.5rem;">Zaregistrovat se</button>
            </form>
        </div>
    </div>

    <!-- MODAL: PÅ™idat / upravit rybÃ¡Å™e -->
    <div id="modal-fisher" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modal-fisher-title">NovÃ½ rybÃ¡Å™</h3>
                <button class="modal-close" id="modal-close-fisher">&times;</button>
            </div>
            <form id="fisher-form">
                <div class="form-group">
                    <label for="fisher-name">JmÃ©no a pÅ™Ã­jmenÃ­</label>
                    <input type="text" id="fisher-name" placeholder="Jan NovÃ¡k" required>
                </div>
                <div class="form-group">
                    <label for="fisher-number">ÄŒÃ­slo rybÃ¡Å™skÃ©ho lÃ­stku</label>
                    <input type="text" id="fisher-number" placeholder="12345">
                </div>
                <div class="form-group">
                    <label for="fisher-phone">Telefon</label>
                    <input type="tel" id="fisher-phone" placeholder="+420 123 456 789">
                </div>
                <button type="submit" class="btn btn-primary btn-full">UloÅ¾it</button>
            </form>
        </div>
    </div>

    <!-- MODAL: QR kÃ³d pro registraci novÃ½ch ÄlenÅ¯ -->
    <div id="modal-qr" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3>ğŸ“± QR kÃ³d â€“ registrace ÄlenÅ¯</h3>
                <button class="modal-close" id="modal-close-qr">&times;</button>
            </div>
            <div class="qr-body">
                <p style="font-size:.85rem;color:var(--text-secondary);margin-bottom:.75rem;text-align:center;">
                    NovÃ½ Älen naskenuje kÃ³d a vyplnÃ­ registraÄnÃ­ formulÃ¡Å™. VyvÄ›ste na nÃ¡stÄ›nce u rybnÃ­ka.
                </p>
                <div id="qr-canvas-wrap" style="display:flex;justify-content:center;"></div>
            </div>
        </div>
    </div>

    <!-- MODAL: NastavenÃ­ -->
    <div id="modal-settings" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3>âš™ï¸ NastavenÃ­</h3>
                <button class="modal-close" id="modal-close-settings">&times;</button>
            </div>
            <div class="settings-section">
                <h4>ğŸ”¥ Firebase â€“ sdÃ­lenÃ­ dat</h4>
                <p class="settings-desc">Bez Firebase jsou data jen v tomto prohlÃ­Å¾eÄi. Firebase = sdÃ­lenÃ­ pÅ™es vÅ¡echna zaÅ™Ã­zenÃ­ v reÃ¡lnÃ©m Äase.</p>
                <div id="firebase-status" class="firebase-status-box"></div>
                <div class="form-group">
                    <label for="settings-firebase-url">Database URL</label>
                    <input type="url" id="settings-firebase-url" placeholder="https://xxx-default-rtdb.europe-west1.firebasedatabase.app">
                </div>
                <div class="form-group">
                    <label for="settings-firebase-key">Web API Key</label>
                    <input type="text" id="settings-firebase-key" placeholder="AIzaSy...">
                </div>
                <button class="btn btn-primary btn-full" id="btn-save-firebase">PÅ™ipojit</button>
                <button class="btn btn-secondary btn-full" id="btn-disconnect-firebase" style="margin-top:0.5rem;display:none;">Odpojit Firebase</button>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast"></div>

    <script src="app.js"></script>
</body>
</html>
